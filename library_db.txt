CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) NOT NULL UNIQUE,
    email VARCHAR(100) NOT NULL UNIQUE,
    password VARCHAR(255) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE notices (
    id INT AUTO_INCREMENT PRIMARY KEY,        -- 공지사항 고유 번호 (자동 증가)
    title VARCHAR(255) NOT NULL,               -- 공지사항 제목
    content TEXT NOT NULL,                     -- 공지사항 내용
    author VARCHAR(100) NOT NULL,              -- 공지사항 작성자
    view_count INT DEFAULT 0,                  -- 조회수 (기본값 0)
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, -- 작성 날짜 (기본값: 현재 시간)
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP -- 수정 날짜 (수정 시 자동 업데이트)
);

CREATE TABLE books (
    id INT AUTO_INCREMENT PRIMARY KEY,     -- 책 고유 번호 (자동 증가)
    title VARCHAR(255) NOT NULL,            -- 책 제목
    author VARCHAR(100) NOT NULL,           -- 저자
    publisher VARCHAR(100) NOT NULL,        -- 출판사
    image_url VARCHAR(255),                 -- 책 표지 이미지 경로
    summary TEXT,                           -- 책 줄거리
    content TEXT,                           -- 책 내용 (한글 파일에서 추출된 내용)
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP -- 책 등록 시간
);

CREATE TABLE reviews (
    id INT AUTO_INCREMENT PRIMARY KEY,
    book_id INT,
    rating INT,       -- 별점 (1~5)
    user_id INT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (book_id) REFERENCES books(id)
);

CREATE TABLE loans (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,
    book_id INT NOT NULL,
    loan_date DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (book_id) REFERENCES books(id) ON DELETE CASCADE
);
ALTER TABLE loans ADD return_date DATETIME;
ALTER TABLE loans ADD COLUMN is_borrowed TINYINT(1) DEFAULT 1;  -- 1은 대출 중, 0은 반납 완료

CREATE TABLE interest_books (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,  -- 사용자 구분을 위한 ID
    book_id INT NOT NULL,  -- 관심 도서의 ID
    added_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (book_id) REFERENCES books(id)
);
ALTER TABLE interest_books ADD COLUMN status ENUM('active', 'inactive') DEFAULT 'active';
ALTER TABLE books MODIFY content LONGTEXT;

​